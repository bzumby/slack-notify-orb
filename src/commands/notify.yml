description: >
  Send slack message on event with custom template.
parameters:
  channel:
    type: string
    default: ""
    description: "Slack Channel ID"
  template:
    type: string
    default: ""
    description: "Template name from slack_tempates folder"
steps:
  - run:
      when: on_fail
      name: 'Slack: set status FAIL'
      command: echo 'export CCI_STATUS=fail' >> $BASH_ENV
  - run:
      when: on_success
      name: 'Slack: set status PASS'
      command: echo 'export CCI_STATUS=pass' >> $BASH_ENV
  - run:
      when: always
      name: 'Slack: notify'
      environment:
        SLACK_CHANNEL: "<<parameters.channel>>"
        basic_job_success: "<<include(slack_templates/basic_job_success.json)>>"
        SLACK_TEMPLATE: "${!<<parameters.template>>}"
      command: <<include(scripts/notify.sh)>>
